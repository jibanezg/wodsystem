<!-- Contacts Background Template -->
<div class="bg-template contacts-template">
    <div class="contacts-list">
        {{#each data.npcs as |npc npcIndex|}}
        <div class="contact-entry">
            <div class="contact-header">
                <input type="text" 
                       name="system.backgroundsExpanded.{{../index}}.templateData.npcs.{{npcIndex}}.name" 
                       value="{{npc.name}}" 
                       placeholder="{{i18n 'WODSYSTEM.CharacterSheet.BackgroundsExpanded.Fields.ContactName'}}" 
                       class="contact-name-input" />
                <a class="delete-contact" data-bg-index="{{../index}}" data-npc-index="{{npcIndex}}" title="{{i18n 'WODSYSTEM.CharacterSheet.BackgroundsExpanded.Fields.RemoveContact'}}">
                    <i class="fas fa-times"></i>
                </a>
            </div>
            
            <div class="contact-details">
                <div class="contact-field">
                    <label>{{i18n 'WODSYSTEM.CharacterSheet.BackgroundsExpanded.Fields.RolePosition'}}</label>
                    <input type="text" 
                           name="system.backgroundsExpanded.{{../index}}.templateData.npcs.{{npcIndex}}.role" 
                           value="{{npc.role}}" 
                           placeholder="{{i18n 'WODSYSTEM.CharacterSheet.BackgroundsExpanded.Fields.RolePositionPlaceholder'}}" 
                           class="contact-input" />
                </div>
                
                <div class="contact-field-row">
                    <div class="contact-field">
                        <label>{{i18n 'WODSYSTEM.CharacterSheet.BackgroundsExpanded.Fields.InfluenceLevel'}}</label>
                        <input type="number" 
                               name="system.backgroundsExpanded.{{../index}}.templateData.npcs.{{npcIndex}}.influence" 
                               value="{{npc.influence}}" 
                               min="1" 
                               max="5" 
                               class="template-input-number-tiny" />
                    </div>
                    
                    <div class="contact-field">
                        <label>{{i18n 'WODSYSTEM.CharacterSheet.BackgroundsExpanded.Fields.Reliability'}}</label>
                        <input type="number" 
                               name="system.backgroundsExpanded.{{../index}}.templateData.npcs.{{npcIndex}}.reliability" 
                               value="{{npc.reliability}}" 
                               min="1" 
                               max="5" 
                               class="template-input-number-tiny" />
                    </div>
                </div>
                
                <div class="contact-field">
                    <label>{{i18n 'WODSYSTEM.CharacterSheet.BackgroundsExpanded.Fields.Notes'}}</label>
                    <textarea name="system.backgroundsExpanded.{{../index}}.templateData.npcs.{{npcIndex}}.notes" 
                              placeholder="{{i18n 'WODSYSTEM.CharacterSheet.BackgroundsExpanded.Fields.ContactsNotesPlaceholder'}}"
                              class="template-textarea">{{npc.notes}}</textarea>
                </div>
            </div>
        </div>
        {{/each}}
    </div>
    
    {{#if isEditMode}}
    <button class="add-contact" data-bg-index="{{index}}" type="button">+ {{i18n 'WODSYSTEM.CharacterSheet.BackgroundsExpanded.Fields.AddContact'}}</button>
    {{/if}}
</div>

