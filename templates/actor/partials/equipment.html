<div class="equipment-tab">
    <!-- Compact Header with Tabs -->
    <div class="equipment-header-compact">
        <div class="equipment-type-tabs">
            <button type="button" class="equipment-type-tab active" data-type="weapons">
                <i class="fas fa-crosshairs"></i> Weapons
            </button>
            <button type="button" class="equipment-type-tab" data-type="armor">
                <i class="fas fa-shield-alt"></i> Armor
            </button>
            <button type="button" class="equipment-type-tab" data-type="gear">
                <i class="fas fa-toolbox"></i> Gear
            </button>
        </div>
    </div>
    
    <!-- Unified Equipment List -->
    <div class="equipment-list">
        <!-- Weapons -->
        {{#each system.equipment.weapons}}
        <div class="equipment-item weapon-item" data-type="weapons" data-item-id="{{this.id}}">
            <div class="item-type-badge weapon-badge">
                <i class="fas fa-crosshairs"></i>
            </div>
            <div class="item-equipped">
                <input type="checkbox" class="weapon-equipped" id="eq-w-{{this.id}}" data-weapon-id="{{this.id}}" {{#if this.equipped}}checked{{/if}} />
                <label for="eq-w-{{this.id}}" title="{{#if this.equipped}}Equipped{{else}}Not Equipped{{/if}}">
                    <i class="fas {{#if this.equipped}}fa-check-circle{{else}}fa-circle{{/if}}"></i>
                </label>
            </div>
            <div class="item-name">
                <input type="text" class="weapon-name" name="system.equipment.weapons.{{@index}}.name" value="{{this.name}}" placeholder="Weapon..." />
            </div>
            <div class="item-stats">
                <span class="stat-mini" title="Damage"><strong>DMG:</strong> <input type="text" name="system.equipment.weapons.{{@index}}.damage" value="{{this.damage}}" /></span>
                <span class="stat-mini" title="Difficulty"><strong>DIF:</strong> <input type="number" name="system.equipment.weapons.{{@index}}.difficulty" value="{{this.difficulty}}" min="2" max="10" /></span>
                <span class="stat-mini" title="Range"><strong>RNG:</strong> <input type="text" name="system.equipment.weapons.{{@index}}.range" value="{{this.range}}" /></span>
                <span class="stat-mini" title="Rate"><strong>RAT:</strong> <input type="text" name="system.equipment.weapons.{{@index}}.rate" value="{{this.rate}}" /></span>
                <span class="stat-mini" title="Clip"><strong>CLP:</strong> <input type="text" name="system.equipment.weapons.{{@index}}.clip" value="{{this.clip}}" /></span>
                <span class="stat-mini" title="Concealment"><strong>CON:</strong> <input type="text" name="system.equipment.weapons.{{@index}}.concealment" value="{{this.concealment}}" /></span>
            </div>
            <div class="item-actions">
                <button type="button" class="manage-effects mini-btn" data-item-id="{{this.id}}" data-item-type="weapon" title="Effects">
                    <i class="fas fa-magic"></i>
                </button>
                <button type="button" class="delete-weapon mini-btn danger" data-weapon-id="{{this.id}}" title="Delete">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
        {{/each}}
        
        <!-- Armor -->
        {{#each system.equipment.armor}}
        <div class="equipment-item armor-item" data-type="armor" data-item-id="{{this.id}}">
            <div class="item-type-badge armor-badge">
                <i class="fas fa-shield-alt"></i>
            </div>
            <div class="item-equipped">
                <input type="checkbox" class="armor-equipped" id="eq-a-{{this.id}}" data-armor-id="{{this.id}}" {{#if this.equipped}}checked{{/if}} />
                <label for="eq-a-{{this.id}}" title="{{#if this.equipped}}Equipped{{else}}Not Equipped{{/if}}">
                    <i class="fas {{#if this.equipped}}fa-check-circle{{else}}fa-circle{{/if}}"></i>
                </label>
            </div>
            <div class="item-name">
                <input type="text" class="armor-name" name="system.equipment.armor.{{@index}}.name" value="{{this.name}}" placeholder="Armor..." />
            </div>
            <div class="item-stats">
                <span class="stat-mini" title="Rating"><strong>RAT:</strong> <input type="number" name="system.equipment.armor.{{@index}}.rating" value="{{this.rating}}" min="0" max="10" /></span>
                <span class="stat-mini" title="Penalty"><strong>PEN:</strong> <input type="number" name="system.equipment.armor.{{@index}}.penalty" value="{{this.penalty}}" min="-5" max="0" /></span>
                <span class="stat-mini stat-desc"><strong>DESC:</strong> <input type="text" name="system.equipment.armor.{{@index}}.description" value="{{this.description}}" placeholder="Description..." /></span>
            </div>
            <div class="item-actions">
                <button type="button" class="manage-effects mini-btn" data-item-id="{{this.id}}" data-item-type="armor" title="Effects">
                    <i class="fas fa-magic"></i>
                </button>
                <button type="button" class="delete-armor mini-btn danger" data-armor-id="{{this.id}}" title="Delete">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
        {{/each}}
        
        <!-- Gear -->
        {{#each system.equipment.gear}}
        <div class="equipment-item gear-item" data-type="gear" data-item-id="{{this.id}}">
            <div class="item-type-badge gear-badge">
                <i class="fas fa-toolbox"></i>
            </div>
            <div class="item-name">
                <input type="text" class="gear-name" name="system.equipment.gear.{{@index}}.name" value="{{this.name}}" placeholder="Gear..." />
            </div>
            <div class="item-stats">
                <span class="stat-mini" title="Quantity"><strong>QTY:</strong> <input type="number" name="system.equipment.gear.{{@index}}.quantity" value="{{this.quantity}}" min="1" /></span>
                <span class="stat-mini" title="Weight"><strong>WGT:</strong> <input type="text" name="system.equipment.gear.{{@index}}.weight" value="{{this.weight}}" placeholder="0 lbs" /></span>
                <span class="stat-mini stat-desc"><strong>DESC:</strong> <input type="text" name="system.equipment.gear.{{@index}}.description" value="{{this.description}}" placeholder="Description..." /></span>
            </div>
            <div class="item-actions">
                <button type="button" class="manage-effects mini-btn" data-item-id="{{this.id}}" data-item-type="gear" title="Effects">
                    <i class="fas fa-magic"></i>
                </button>
                <button type="button" class="delete-gear mini-btn danger" data-gear-id="{{this.id}}" title="Delete">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
        {{/each}}
        
        <!-- Empty State -->
        {{#unless (or system.equipment.weapons.length system.equipment.armor.length system.equipment.gear.length)}}
        <div class="equipment-empty">
            <i class="fas fa-shield-alt"></i>
            <p>No equipment added yet</p>
        </div>
        {{/unless}}
    </div>
    
    <!-- Context-aware Add Buttons -->
    <div class="equipment-footer">
        <button type="button" class="add-weapon footer-add-btn" data-for="weapons">
            <i class="fas fa-plus"></i> Add Weapon
        </button>
        <button type="button" class="add-armor footer-add-btn" data-for="armor">
            <i class="fas fa-plus"></i> Add Armor
        </button>
        <button type="button" class="add-gear footer-add-btn" data-for="gear">
            <i class="fas fa-plus"></i> Add Gear
        </button>
    </div>
</div>
